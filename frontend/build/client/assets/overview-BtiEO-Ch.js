import{w as ne}from"./chunk-UIGDSWPH-DZWXMQ1q.js";import{j as e,r as s}from"./catchall-DnhblMTB.js";import{a as se,g as ie,A as le,d as ce}from"./AlertDialogButton-md8iv1Ji.js";import{u as de,a as ue,T as pe,b as me,c as N,d as fe,f as I,e as he,g as M,h as ge,i as xe,j as ve,k as je,C as T,E as ye}from"./checkbox-BnueBj7s.js";import{u as G,s as be}from"./AuthContext-CaC8Ux1v.js";import{B as C}from"./button-DRdsxmUd.js";import{c as V,u as we,R as Ce,I as Re,D as Se,a as Ne,b as Pe,d as ke,e as De,f as _e}from"./dropdown-menu-DBwaQkbh.js";import{T as H}from"./index-BQcZugzN.js";import{t as D}from"./index-8kEh58Qm.js";import{I as P}from"./label-5iLYS0_Z.js";import{R as Fe,T as Ee,C as Ie,d as B,b as Me,D as Te,P as Ae,O as Oe,u as qe,a as _,e as ze,f as Ge}from"./index-DeenmED4.js";import{c as y,d as Ve,u as F}from"./utils-CXVXd1Lc.js";import{X as He}from"./x-Bgx3e7OV.js";import{d as A,F as Be,a as w,b,c as O}from"./field-DZvDSfuf.js";import"./index-ByB3n5A_.js";import{c as $e}from"./createLucideIcon-B0bOrvaQ.js";import{P as Le}from"./plus-DWsedYH4.js";import"./index-Cn7NbXT4.js";/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ke=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Ue=$e("circle",Ke);function We({...t}){return e.jsx(Fe,{"data-slot":"dialog",...t})}function Xe({...t}){return e.jsx(Ee,{"data-slot":"dialog-trigger",...t})}function Ze({...t}){return e.jsx(Ae,{"data-slot":"dialog-portal",...t})}function Ye({...t}){return e.jsx(B,{"data-slot":"dialog-close",...t})}function Je({className:t,...o}){return e.jsx(Oe,{"data-slot":"dialog-overlay",className:y("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",t),...o})}function Qe({className:t,children:o,showCloseButton:a=!0,...n}){return e.jsxs(Ze,{"data-slot":"dialog-portal",children:[e.jsx(Je,{}),e.jsxs(Ie,{"data-slot":"dialog-content",className:y("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",t),...n,children:[o,a&&e.jsxs(B,{"data-slot":"dialog-close",className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[e.jsx(He,{}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]})}function et({className:t,...o}){return e.jsx("div",{"data-slot":"dialog-header",className:y("flex flex-col gap-2 text-center sm:text-left",t),...o})}function tt({className:t,...o}){return e.jsx("div",{"data-slot":"dialog-footer",className:y("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",t),...o})}function ot({className:t,...o}){return e.jsx(Me,{"data-slot":"dialog-title",className:y("text-lg leading-none font-semibold",t),...o})}function rt({className:t,...o}){return e.jsx(Te,{"data-slot":"dialog-description",className:y("text-muted-foreground text-sm",t),...o})}function $(t,o=[]){let a=[];function n(l,i){const c=s.createContext(i),d=a.length;a=[...a,i];const p=m=>{const{scope:x,children:h,...u}=m,j=x?.[t]?.[d]||c,g=s.useMemo(()=>u,Object.values(u));return e.jsx(j.Provider,{value:g,children:h})};p.displayName=l+"Provider";function f(m,x){const h=x?.[t]?.[d]||c,u=s.useContext(h);if(u)return u;if(i!==void 0)return i;throw new Error(`\`${m}\` must be used within \`${l}\``)}return[p,f]}const r=()=>{const l=a.map(i=>s.createContext(i));return function(c){const d=c?.[t]||l;return s.useMemo(()=>({[`__scope${t}`]:{...c,[t]:d}}),[c,d])}};return r.scopeName=t,[n,at(r,...o)]}function at(...t){const o=t[0];if(t.length===1)return o;const a=()=>{const n=t.map(r=>({useScope:r(),scopeName:r.scopeName}));return function(l){const i=n.reduce((c,{useScope:d,scopeName:p})=>{const m=d(l)[`__scope${p}`];return{...c,...m}},{});return s.useMemo(()=>({[`__scope${o.scopeName}`]:i}),[i])}};return a.scopeName=o.scopeName,a}function nt(t){const o=st(t),a=s.forwardRef((n,r)=>{const{children:l,...i}=n,c=s.Children.toArray(l),d=c.find(lt);if(d){const p=d.props.children,f=c.map(m=>m===d?s.Children.count(p)>1?s.Children.only(null):s.isValidElement(p)?p.props.children:null:m);return e.jsx(o,{...i,ref:r,children:s.isValidElement(p)?s.cloneElement(p,void 0,f):null})}return e.jsx(o,{...i,ref:r,children:l})});return a.displayName=`${t}.Slot`,a}function st(t){const o=s.forwardRef((a,n)=>{const{children:r,...l}=a;if(s.isValidElement(r)){const i=dt(r),c=ct(l,r.props);return r.type!==s.Fragment&&(c.ref=n?Ve(n,i):i),s.cloneElement(r,c)}return s.Children.count(r)>1?s.Children.only(null):null});return o.displayName=`${t}.SlotClone`,o}var it=Symbol("radix.slottable");function lt(t){return s.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===it}function ct(t,o){const a={...o};for(const n in o){const r=t[n],l=o[n];/^on[A-Z]/.test(n)?r&&l?a[n]=(...c)=>{const d=l(...c);return r(...c),d}:r&&(a[n]=r):n==="style"?a[n]={...r,...l}:n==="className"&&(a[n]=[r,l].filter(Boolean).join(" "))}return{...t,...a}}function dt(t){let o=Object.getOwnPropertyDescriptor(t.props,"ref")?.get,a=o&&"isReactWarning"in o&&o.isReactWarning;return a?t.ref:(o=Object.getOwnPropertyDescriptor(t,"ref")?.get,a=o&&"isReactWarning"in o&&o.isReactWarning,a?t.props.ref:t.props.ref||t.ref)}var ut=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],R=ut.reduce((t,o)=>{const a=nt(`Primitive.${o}`),n=s.forwardRef((r,l)=>{const{asChild:i,...c}=r,d=i?a:o;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),e.jsx(d,{...c,ref:l})});return n.displayName=`Primitive.${o}`,{...t,[o]:n}},{}),E="Radio",[pt,L]=$(E),[mt,ft]=pt(E),K=s.forwardRef((t,o)=>{const{__scopeRadio:a,name:n,checked:r=!1,required:l,disabled:i,value:c="on",onCheck:d,form:p,...f}=t,[m,x]=s.useState(null),h=F(o,g=>x(g)),u=s.useRef(!1),j=m?p||!!m.closest("form"):!0;return e.jsxs(mt,{scope:a,checked:r,disabled:i,children:[e.jsx(R.button,{type:"button",role:"radio","aria-checked":r,"data-state":Z(r),"data-disabled":i?"":void 0,disabled:i,value:c,...f,ref:h,onClick:_(t.onClick,g=>{r||d?.(),j&&(u.current=g.isPropagationStopped(),u.current||g.stopPropagation())})}),j&&e.jsx(X,{control:m,bubbles:!u.current,name:n,value:c,checked:r,required:l,disabled:i,form:p,style:{transform:"translateX(-100%)"}})]})});K.displayName=E;var U="RadioIndicator",W=s.forwardRef((t,o)=>{const{__scopeRadio:a,forceMount:n,...r}=t,l=ft(U,a);return e.jsx(ze,{present:n||l.checked,children:e.jsx(R.span,{"data-state":Z(l.checked),"data-disabled":l.disabled?"":void 0,...r,ref:o})})});W.displayName=U;var ht="RadioBubbleInput",X=s.forwardRef(({__scopeRadio:t,control:o,checked:a,bubbles:n=!0,...r},l)=>{const i=s.useRef(null),c=F(i,l),d=de(a),p=Ge(o);return s.useEffect(()=>{const f=i.current;if(!f)return;const m=window.HTMLInputElement.prototype,h=Object.getOwnPropertyDescriptor(m,"checked").set;if(d!==a&&h){const u=new Event("click",{bubbles:n});h.call(f,a),f.dispatchEvent(u)}},[d,a,n]),e.jsx(R.input,{type:"radio","aria-hidden":!0,defaultChecked:a,...r,tabIndex:-1,ref:c,style:{...r.style,...p,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});X.displayName=ht;function Z(t){return t?"checked":"unchecked"}var gt=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],S="RadioGroup",[xt,Kt]=$(S,[V,L]),Y=V(),J=L(),[vt,jt]=xt(S),Q=s.forwardRef((t,o)=>{const{__scopeRadioGroup:a,name:n,defaultValue:r,value:l,required:i=!1,disabled:c=!1,orientation:d,dir:p,loop:f=!0,onValueChange:m,...x}=t,h=Y(a),u=we(p),[j,g]=qe({prop:l,defaultProp:r??null,onChange:m,caller:S});return e.jsx(vt,{scope:a,name:n,required:i,disabled:c,value:j,onValueChange:g,children:e.jsx(Ce,{asChild:!0,...h,orientation:d,dir:u,loop:f,children:e.jsx(R.div,{role:"radiogroup","aria-required":i,"aria-orientation":d,"data-disabled":c?"":void 0,dir:u,...x,ref:o})})})});Q.displayName=S;var ee="RadioGroupItem",te=s.forwardRef((t,o)=>{const{__scopeRadioGroup:a,disabled:n,...r}=t,l=jt(ee,a),i=l.disabled||n,c=Y(a),d=J(a),p=s.useRef(null),f=F(o,p),m=l.value===r.value,x=s.useRef(!1);return s.useEffect(()=>{const h=j=>{gt.includes(j.key)&&(x.current=!0)},u=()=>x.current=!1;return document.addEventListener("keydown",h),document.addEventListener("keyup",u),()=>{document.removeEventListener("keydown",h),document.removeEventListener("keyup",u)}},[]),e.jsx(Re,{asChild:!0,...c,focusable:!i,active:m,children:e.jsx(K,{disabled:i,required:l.required,checked:m,...d,...r,name:l.name,ref:f,onCheck:()=>l.onValueChange(r.value),onKeyDown:_(h=>{h.key==="Enter"&&h.preventDefault()}),onFocus:_(r.onFocus,()=>{x.current&&p.current?.click()})})})});te.displayName=ee;var yt="RadioGroupIndicator",oe=s.forwardRef((t,o)=>{const{__scopeRadioGroup:a,...n}=t,r=J(a);return e.jsx(W,{...r,...n,ref:o})});oe.displayName=yt;var bt=Q,wt=te,Ct=oe;function Rt({className:t,...o}){return e.jsx(bt,{"data-slot":"radio-group",className:y("grid gap-3",t),...o})}function k({className:t,...o}){return e.jsx(wt,{"data-slot":"radio-group-item",className:y("border-input text-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 aspect-square size-4 shrink-0 rounded-full border shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",t),...o,children:e.jsx(Ct,{"data-slot":"radio-group-indicator",className:"relative flex items-center justify-center",children:e.jsx(Ue,{className:"fill-primary absolute top-1/2 left-1/2 size-2 -translate-x-1/2 -translate-y-1/2"})})})}function St({className:t,...o}){return e.jsx("textarea",{"data-slot":"textarea",className:y("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),...o})}const q={name:"ex. drink more water",description:"Optionally include a brief description...",status:"active",unit:"unit",frequency:"daily",goal:0,reminder_time:null,is_archived:!1};function Nt({isOpen:t,open:o}){const{user:a}=G(),[n,r]=s.useState(q),l=d=>{r(p=>({...p,frequency:d}))},i=d=>{const{name:p,value:f,type:m}=d.target;r(x=>({...x,[p]:p==="goal"?Number(f):f}))},c=async d=>{if(d.preventDefault(),console.log("touched",n),!a||n===q)return;const p=new H().toISOString().split("T")[0];try{await se({user_id:a.id,name:n.name,description:n.description==="Optionally include a brief description..."?"":n.description,status:"active",unit:n.unit,frequency:n.frequency,goal:n.goal,reminder_time:null,is_archived:!1}),setHabits(f=>[...f,{...n,created_at:p}]),t(!1),D.success("Successfully added a new habit.")}catch{D.error("Failed to create.")}};return e.jsx(e.Fragment,{children:e.jsx(We,{open:o,onOpenChange:t,children:e.jsxs("form",{children:[e.jsx(Xe,{asChild:!0,children:e.jsxs(C,{variant:"outline",children:[e.jsx(Le,{})," Habit"]})}),e.jsxs(Qe,{className:"sm:max-w-[425px]",children:[e.jsxs(et,{children:[e.jsx(ot,{children:"Create a new Habit."}),e.jsx(rt,{children:"Fill out the form here. Click create when you're done."})]}),e.jsx("div",{className:"w-full max-w-md",children:e.jsx(A,{children:e.jsxs(Be,{children:[e.jsxs(w,{children:[e.jsx(b,{htmlFor:"name",children:"Habit Name"}),e.jsx(P,{id:"name",name:"name",type:"text",placeholder:"ex. drink more water",onChange:i,required:!0}),e.jsx(O,{children:"Choose the name of your new habit."})]}),e.jsxs(w,{children:[e.jsx(b,{htmlFor:"feedback",children:"Description"}),e.jsx(St,{id:"description",name:"description",placeholder:"Optionally include a brief description...",rows:4,onChange:i})]}),e.jsxs(A,{children:[e.jsx(b,{children:"Frequency Plan"}),e.jsx(O,{children:"Select how frequent you plan to perform this habit."}),e.jsxs(Rt,{name:"frequency",defaultValue:"daily",onValueChange:l,required:!0,children:[e.jsxs(w,{orientation:"horizontal",children:[e.jsx(k,{value:"daily",id:"plan-daily"}),e.jsx(b,{htmlFor:"plan-daily",className:"font-normal",children:"Daily"})]}),e.jsxs(w,{orientation:"horizontal",children:[e.jsx(k,{value:"weekly",id:"plan-weekly"}),e.jsx(b,{htmlFor:"plan-weekly",className:"font-normal",children:"Weekly"})]}),e.jsxs(w,{orientation:"horizontal",children:[e.jsx(k,{value:"monthly",id:"plan-monthly"}),e.jsx(b,{htmlFor:"plan-monthly",className:"font-normal",children:"Monthly"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs(w,{children:[e.jsx(b,{htmlFor:"city",children:"Frequency Goal"}),e.jsx(P,{id:"goal",name:"goal",type:"number",min:0,placeholder:"0",onChange:i,required:!0})]}),e.jsxs(w,{children:[e.jsx(b,{htmlFor:"unit",children:"Unit To Measure"}),e.jsx(P,{id:"unit",name:"unit",type:"text",placeholder:"ex. ounces or oz",onChange:i,required:!0})]})]})]})})}),e.jsxs(tt,{children:[e.jsx(Ye,{asChild:!0,children:e.jsx(C,{variant:"outline",children:"Cancel"})}),e.jsx(C,{type:"submit",onClick:c,children:"Create Habit"})]})]})]})})})}async function Ut(){const{data:{user:t}}=await be.auth.getUser();return t?await ie(t.id):void 0}const z=[{id:"select",header:({table:t})=>e.jsx(T,{checked:t.getIsAllPageRowsSelected()||t.getIsSomePageRowsSelected()&&"indeterminate",onCheckedChange:o=>t.toggleAllPageRowsSelected(!!o),"aria-label":"Select all"}),cell:({row:t})=>e.jsx(T,{checked:t.getIsSelected(),onCheckedChange:o=>{t.toggleSelected(!!o)},"aria-label":"Select row"}),enableSorting:!1,enableHiding:!1},{accessorKey:"name",header:"Name",cell:({row:t})=>e.jsx("div",{className:"capitalize",children:t.getValue("name")})},{accessorKey:"goal",header:"Frequency Goal",cell:({row:t})=>e.jsx("div",{className:"capitalize",children:t.getValue("goal")})},{accessorKey:"frequency",header:"Frequency",cell:({row:t})=>e.jsx("div",{className:"capitalize",children:t.getValue("frequency")})},{accessorKey:"unit",header:()=>e.jsx("div",{className:"capitalize",children:"Unit Type"}),cell:({row:t})=>e.jsx("div",{className:" font-semibold text-slate-500",children:t.getValue("unit")})},{accessorKey:"status",header:"Status",cell:({row:t})=>e.jsx("div",{className:"capitalize",children:t.getValue("status")})},{accessorKey:"created_at",header:"Created At",cell:({row:t})=>{const o=new H(t.getValue("created_at")).toISOString().split("T")[0];return e.jsx("div",{className:"capitalize",children:o})}},{id:"actions",enableHiding:!1,cell:({row:t})=>{const o=t.original;return e.jsxs(Se,{children:[e.jsx(Ne,{asChild:!0,children:e.jsxs(C,{variant:"ghost",className:"h-8 w-8 p-0",children:[e.jsx("span",{className:"sr-only",children:"Open menu"}),e.jsx(ye,{})]})}),e.jsxs(Pe,{align:"end",children:[e.jsx(ke,{children:"Actions"}),e.jsx(De,{onClick:()=>navigator.clipboard.writeText(o.id),children:"Copy Entry ID"}),e.jsx(_e,{})]})]})}}],Pt=({loaderData:t})=>{const{user:o}=G(),[a,n]=s.useState(!1),[r,l]=s.useState(t),[i,c]=s.useState([]),[d,p]=s.useState([]),[f,m]=s.useState({}),[x,h]=s.useState({}),u=ue({data:r,columns:z,onSortingChange:c,onColumnFiltersChange:p,getCoreRowModel:je(),getPaginationRowModel:ve(),getSortedRowModel:xe(),getFilteredRowModel:ge(),onColumnVisibilityChange:m,onRowSelectionChange:h,state:{sorting:i,columnFilters:d,columnVisibility:f,rowSelection:x}}),j=async()=>{if(!o)return;const g=u.getFilteredSelectedRowModel().rows.map(v=>v.original.id);await ce(g),l(v=>v.filter(re=>!g.find(ae=>ae===re.id))),h({}),D.success("Habit(s) deleted")};return s.useEffect(()=>{r.length===0&&n(!0)},[]),e.jsxs("div",{className:"w-full",children:[e.jsx("div",{className:"flex items-center py-4",children:e.jsxs("div",{className:"flex ml-auto gap-2 w-full max-w-sm ",children:[e.jsx("div",{className:"w-full",children:e.jsx(le,{onContinue:j,variant:u.getFilteredSelectedRowModel().rows.length>0?"destructive":"outline",disabled:u.getFilteredSelectedRowModel().rows.length<=0,dialingDesc:"Action cannot be undone.",buttonText:`Delete ${u.getFilteredSelectedRowModel().rows.length>0?`Batch (${u.getFilteredSelectedRowModel().rows.length} rows)`:""}`})}),e.jsx(Nt,{open:a,isOpen:n})]})}),e.jsx("div",{className:"overflow-hidden rounded-md border",children:e.jsxs(pe,{children:[e.jsx(me,{children:u.getHeaderGroups().map(g=>e.jsx(N,{children:g.headers.map(v=>e.jsx(fe,{children:v.isPlaceholder?null:I(v.column.columnDef.header,v.getContext())},v.id))},g.id))}),e.jsx(he,{children:u.getRowModel().rows?.length?u.getRowModel().rows.map(g=>e.jsx(N,{"data-state":g.getIsSelected()&&"selected",children:g.getVisibleCells().map(v=>e.jsx(M,{children:I(v.column.columnDef.cell,v.getContext())},v.id))},g.id)):e.jsx(N,{children:e.jsx(M,{colSpan:z.length,className:"h-24 text-center",children:"No results."})})})]})}),e.jsxs("div",{className:"flex items-center justify-end space-x-2 py-4",children:[e.jsxs("div",{className:"text-muted-foreground flex-1 text-sm",children:[u.getFilteredSelectedRowModel().rows.length," of"," ",u.getFilteredRowModel().rows.length," row(s) selected."]}),e.jsxs("div",{className:"space-x-2",children:[e.jsx(C,{variant:"outline",size:"sm",onClick:()=>u.previousPage(),disabled:!u.getCanPreviousPage(),children:"Previous"}),e.jsx(C,{variant:"outline",size:"sm",onClick:()=>u.nextPage(),disabled:!u.getCanNextPage(),children:"Next"})]})]})]})},Wt=ne(Pt);export{Ut as clientLoader,Wt as default};
