import{w as re}from"./chunk-4WY6JWTD-ZsAaRs5U.js";import{j as e,r as i}from"./catchall-DRODuvbv.js";import{a as ne,g as ie,A as le,d as de}from"./AlertDialogButton-ClfBn6-I.js";import{u as ce,a as ue,T as pe,b as me,c as S,d as he,f as _,e as ge,g as T,h as fe,i as xe,j as ve,k as je,C as E,E as be}from"./table-B4azczwb.js";import{c as ye,u as H,s as we}from"./AuthContext-BKiGfsZR.js";import{B as R}from"./button-DQSlb20C.js";import{c as O,u as Re,R as Ce,I as Ne,D as Se,a as ke,b as De,d as Fe,e as Pe,f as Ie}from"./dropdown-menu-D8Wxq2GU.js";import{T as V}from"./index-BQcZugzN.js";import{t as F}from"./index-CfvZiKZg.js";import{I as k}from"./label-DKIyjlKT.js";import{R as Me,T as _e,C as Te,e as B,d as Ee,D as Ae,f as qe,O as ze,u as Ge,a as K,P as C,b as P,g as He,h as Oe}from"./index-BThBl4SO.js";import{c as j}from"./utils-CDN07tui.js";import{X as Ve}from"./x-DcuplUIX.js";import{d as A,F as Be,a as w,b as y,c as q}from"./field-JfzP6Rf4.js";import{u as I}from"./index-olsFugHa.js";import{P as Ke}from"./plus-BAh2oPY2.js";import"./index-DJR0yQkD.js";const Le=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Ue=ye("circle",Le);function $e({...t}){return e.jsx(Me,{"data-slot":"dialog",...t})}function We({...t}){return e.jsx(_e,{"data-slot":"dialog-trigger",...t})}function Xe({...t}){return e.jsx(qe,{"data-slot":"dialog-portal",...t})}function Ye({...t}){return e.jsx(B,{"data-slot":"dialog-close",...t})}function Ze({className:t,...a}){return e.jsx(ze,{"data-slot":"dialog-overlay",className:j("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",t),...a})}function Je({className:t,children:a,showCloseButton:r=!0,...l}){return e.jsxs(Xe,{"data-slot":"dialog-portal",children:[e.jsx(Ze,{}),e.jsxs(Te,{"data-slot":"dialog-content",className:j("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",t),...l,children:[a,r&&e.jsxs(B,{"data-slot":"dialog-close",className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[e.jsx(Ve,{}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]})}function Qe({className:t,...a}){return e.jsx("div",{"data-slot":"dialog-header",className:j("flex flex-col gap-2 text-center sm:text-left",t),...a})}function et({className:t,...a}){return e.jsx("div",{"data-slot":"dialog-footer",className:j("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",t),...a})}function tt({className:t,...a}){return e.jsx(Ee,{"data-slot":"dialog-title",className:j("text-lg leading-none font-semibold",t),...a})}function at({className:t,...a}){return e.jsx(Ae,{"data-slot":"dialog-description",className:j("text-muted-foreground text-sm",t),...a})}var M="Radio",[ot,L]=K(M),[st,rt]=ot(M),U=i.forwardRef((t,a)=>{const{__scopeRadio:r,name:l,checked:o=!1,required:n,disabled:c,value:h="on",onCheck:f,form:u,...d}=t,[p,v]=i.useState(null),m=I(a,g=>v(g)),s=i.useRef(!1),b=p?u||!!p.closest("form"):!0;return e.jsxs(st,{scope:r,checked:o,disabled:c,children:[e.jsx(C.button,{type:"button",role:"radio","aria-checked":o,"data-state":Y(o),"data-disabled":c?"":void 0,disabled:c,value:h,...d,ref:m,onClick:P(t.onClick,g=>{o||f?.(),b&&(s.current=g.isPropagationStopped(),s.current||g.stopPropagation())})}),b&&e.jsx(X,{control:p,bubbles:!s.current,name:l,value:h,checked:o,required:n,disabled:c,form:u,style:{transform:"translateX(-100%)"}})]})});U.displayName=M;var $="RadioIndicator",W=i.forwardRef((t,a)=>{const{__scopeRadio:r,forceMount:l,...o}=t,n=rt($,r);return e.jsx(He,{present:l||n.checked,children:e.jsx(C.span,{"data-state":Y(n.checked),"data-disabled":n.disabled?"":void 0,...o,ref:a})})});W.displayName=$;var nt="RadioBubbleInput",X=i.forwardRef(({__scopeRadio:t,control:a,checked:r,bubbles:l=!0,...o},n)=>{const c=i.useRef(null),h=I(c,n),f=ce(r),u=Oe(a);return i.useEffect(()=>{const d=c.current;if(!d)return;const p=window.HTMLInputElement.prototype,m=Object.getOwnPropertyDescriptor(p,"checked").set;if(f!==r&&m){const s=new Event("click",{bubbles:l});m.call(d,r),d.dispatchEvent(s)}},[f,r,l]),e.jsx(C.input,{type:"radio","aria-hidden":!0,defaultChecked:r,...o,tabIndex:-1,ref:h,style:{...o.style,...u,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});X.displayName=nt;function Y(t){return t?"checked":"unchecked"}var it=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],N="RadioGroup",[lt]=K(N,[O,L]),Z=O(),J=L(),[dt,ct]=lt(N),Q=i.forwardRef((t,a)=>{const{__scopeRadioGroup:r,name:l,defaultValue:o,value:n,required:c=!1,disabled:h=!1,orientation:f,dir:u,loop:d=!0,onValueChange:p,...v}=t,m=Z(r),s=Re(u),[b,g]=Ge({prop:n,defaultProp:o??null,onChange:p,caller:N});return e.jsx(dt,{scope:r,name:l,required:c,disabled:h,value:b,onValueChange:g,children:e.jsx(Ce,{asChild:!0,...m,orientation:f,dir:s,loop:d,children:e.jsx(C.div,{role:"radiogroup","aria-required":c,"aria-orientation":f,"data-disabled":h?"":void 0,dir:s,...v,ref:a})})})});Q.displayName=N;var ee="RadioGroupItem",te=i.forwardRef((t,a)=>{const{__scopeRadioGroup:r,disabled:l,...o}=t,n=ct(ee,r),c=n.disabled||l,h=Z(r),f=J(r),u=i.useRef(null),d=I(a,u),p=n.value===o.value,v=i.useRef(!1);return i.useEffect(()=>{const m=b=>{it.includes(b.key)&&(v.current=!0)},s=()=>v.current=!1;return document.addEventListener("keydown",m),document.addEventListener("keyup",s),()=>{document.removeEventListener("keydown",m),document.removeEventListener("keyup",s)}},[]),e.jsx(Ne,{asChild:!0,...h,focusable:!c,active:p,children:e.jsx(U,{disabled:c,required:n.required,checked:p,...f,...o,name:n.name,ref:d,onCheck:()=>n.onValueChange(o.value),onKeyDown:P(m=>{m.key==="Enter"&&m.preventDefault()}),onFocus:P(o.onFocus,()=>{v.current&&u.current?.click()})})})});te.displayName=ee;var ut="RadioGroupIndicator",ae=i.forwardRef((t,a)=>{const{__scopeRadioGroup:r,...l}=t,o=J(r);return e.jsx(W,{...o,...l,ref:a})});ae.displayName=ut;var pt=Q,mt=te,ht=ae;function gt({className:t,...a}){return e.jsx(pt,{"data-slot":"radio-group",className:j("grid gap-3",t),...a})}function D({className:t,...a}){return e.jsx(mt,{"data-slot":"radio-group-item",className:j("border-input text-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 aspect-square size-4 shrink-0 rounded-full border shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",t),...a,children:e.jsx(ht,{"data-slot":"radio-group-indicator",className:"relative flex items-center justify-center",children:e.jsx(Ue,{className:"fill-primary absolute top-1/2 left-1/2 size-2 -translate-x-1/2 -translate-y-1/2"})})})}function ft({className:t,...a}){return e.jsx("textarea",{"data-slot":"textarea",className:j("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),...a})}const z={name:"ex. drink more water",description:"Optionally include a brief description...",status:"active",unit:"unit",frequency:"daily",goal:0,reminder_time:null,is_archived:!1};function xt({isOpen:t,open:a,setHabits:r}){const{user:l}=H(),[o,n]=i.useState(z),c=u=>{n(d=>({...d,frequency:u}))},h=u=>{const{name:d,value:p,type:v}=u.target;n(m=>({...m,[d]:d==="goal"?Number(p):p}))},f=async u=>{if(u.preventDefault(),console.log("touched",o),!l||o===z)return;const d=new V().toISOString().split("T")[0];try{await ne({user_id:l.id,name:o.name,description:o.description==="Optionally include a brief description..."?"":o.description,status:"active",unit:o.unit,frequency:o.frequency,goal:o.goal,reminder_time:null,is_archived:!1}),r(p=>[...p,{...o,created_at:d}]),t(!1),F.success("Successfully added a new habit.")}catch{F.error("Failed to create.")}};return e.jsx(e.Fragment,{children:e.jsx($e,{open:a,onOpenChange:t,children:e.jsxs("form",{children:[e.jsx(We,{asChild:!0,children:e.jsxs(R,{variant:"outline",children:[e.jsx(Ke,{})," Habit"]})}),e.jsxs(Je,{className:"sm:max-w-[425px]",children:[e.jsxs(Qe,{children:[e.jsx(tt,{children:"Create a new Habit."}),e.jsx(at,{children:"Fill out the form here. Click create when you're done."})]}),e.jsx("div",{className:"w-full max-w-md",children:e.jsx(A,{children:e.jsxs(Be,{children:[e.jsxs(w,{children:[e.jsx(y,{htmlFor:"name",children:"Habit Name"}),e.jsx(k,{id:"name",name:"name",type:"text",placeholder:"ex. drink more water",onChange:h,required:!0}),e.jsx(q,{children:"Choose the name of your new habit."})]}),e.jsxs(w,{children:[e.jsx(y,{htmlFor:"feedback",children:"Description"}),e.jsx(ft,{id:"description",name:"description",placeholder:"Optionally include a brief description...",rows:4,onChange:h})]}),e.jsxs(A,{children:[e.jsx(y,{children:"Frequency Plan"}),e.jsx(q,{children:"Select how frequent you plan to perform this habit."}),e.jsxs(gt,{name:"frequency",defaultValue:"daily",onValueChange:c,required:!0,children:[e.jsxs(w,{orientation:"horizontal",children:[e.jsx(D,{value:"daily",id:"plan-daily"}),e.jsx(y,{htmlFor:"plan-daily",className:"font-normal",children:"Daily"})]}),e.jsxs(w,{orientation:"horizontal",children:[e.jsx(D,{value:"weekly",id:"plan-weekly"}),e.jsx(y,{htmlFor:"plan-weekly",className:"font-normal",children:"Weekly"})]}),e.jsxs(w,{orientation:"horizontal",children:[e.jsx(D,{value:"monthly",id:"plan-monthly"}),e.jsx(y,{htmlFor:"plan-monthly",className:"font-normal",children:"Monthly"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs(w,{children:[e.jsx(y,{htmlFor:"city",children:"Frequency Goal"}),e.jsx(k,{id:"goal",name:"goal",type:"number",min:0,placeholder:"0",onChange:h,required:!0})]}),e.jsxs(w,{children:[e.jsx(y,{htmlFor:"unit",children:"Unit To Measure"}),e.jsx(k,{id:"unit",name:"unit",type:"text",placeholder:"ex. ounces or oz",onChange:h,required:!0})]})]})]})})}),e.jsxs(et,{children:[e.jsx(Ye,{asChild:!0,children:e.jsx(R,{variant:"outline",children:"Cancel"})}),e.jsx(R,{type:"submit",onClick:f,children:"Create Habit"})]})]})]})})})}async function At(){const{data:{user:t}}=await we.auth.getUser();return t?await ie(t.id):void 0}const G=[{id:"select",header:({table:t})=>e.jsx(E,{checked:t.getIsAllPageRowsSelected()||t.getIsSomePageRowsSelected()&&"indeterminate",onCheckedChange:a=>t.toggleAllPageRowsSelected(!!a),"aria-label":"Select all"}),cell:({row:t})=>e.jsx(E,{checked:t.getIsSelected(),onCheckedChange:a=>{t.toggleSelected(!!a)},"aria-label":"Select row"}),enableSorting:!1,enableHiding:!1},{accessorKey:"name",header:"Name",cell:({row:t})=>e.jsx("div",{className:"capitalize",children:t.getValue("name")})},{accessorKey:"goal",header:"Frequency Goal",cell:({row:t})=>e.jsx("div",{className:"capitalize",children:t.getValue("goal")})},{accessorKey:"frequency",header:"Frequency",cell:({row:t})=>e.jsx("div",{className:"capitalize",children:t.getValue("frequency")})},{accessorKey:"unit",header:()=>e.jsx("div",{className:"capitalize",children:"Unit Type"}),cell:({row:t})=>e.jsx("div",{className:" font-semibold text-slate-500",children:t.getValue("unit")})},{accessorKey:"status",header:"Status",cell:({row:t})=>e.jsx("div",{className:"capitalize",children:t.getValue("status")})},{accessorKey:"created_at",header:"Created At",cell:({row:t})=>{const a=new V(t.getValue("created_at")).toISOString().split("T")[0];return e.jsx("div",{className:"capitalize",children:a})}},{id:"actions",enableHiding:!1,cell:({row:t})=>{const a=t.original;return e.jsxs(Se,{children:[e.jsx(ke,{asChild:!0,children:e.jsxs(R,{variant:"ghost",className:"h-8 w-8 p-0",children:[e.jsx("span",{className:"sr-only",children:"Open menu"}),e.jsx(be,{})]})}),e.jsxs(De,{align:"end",children:[e.jsx(Fe,{children:"Actions"}),e.jsx(Pe,{onClick:()=>navigator.clipboard.writeText(a.id),children:"Copy Entry ID"}),e.jsx(Ie,{})]})]})}}],vt=({loaderData:t})=>{const{user:a}=H(),[r,l]=i.useState(!1),[o,n]=i.useState(t),[c,h]=i.useState([]),[f,u]=i.useState([]),[d,p]=i.useState({}),[v,m]=i.useState({}),s=ue({data:o,columns:G,onSortingChange:h,onColumnFiltersChange:u,getCoreRowModel:je(),getPaginationRowModel:ve(),getSortedRowModel:xe(),getFilteredRowModel:fe(),onColumnVisibilityChange:p,onRowSelectionChange:m,state:{sorting:c,columnFilters:f,columnVisibility:d,rowSelection:v}}),b=async()=>{if(!a)return;const g=s.getFilteredSelectedRowModel().rows.map(x=>x.original.id);await de(g),n(x=>x.filter(oe=>!g.find(se=>se===oe.id))),m({}),F.success("Habit(s) deleted")};return i.useEffect(()=>{o.length===0&&l(!0)},[]),e.jsxs("div",{className:"w-full",children:[e.jsx("div",{className:"flex items-center py-4",children:e.jsxs("div",{className:"flex ml-auto gap-2 w-full max-w-sm ",children:[e.jsx("div",{className:"w-full",children:e.jsx(le,{onContinue:b,variant:s.getFilteredSelectedRowModel().rows.length>0?"destructive":"outline",disabled:s.getFilteredSelectedRowModel().rows.length<=0,dialingDesc:"Action cannot be undone.",buttonText:`Delete ${s.getFilteredSelectedRowModel().rows.length>0?`Batch (${s.getFilteredSelectedRowModel().rows.length} rows)`:""}`})}),e.jsx(xt,{open:r,isOpen:l,setHabits:n})]})}),e.jsx("div",{className:"overflow-hidden rounded-md border",children:e.jsxs(pe,{children:[e.jsx(me,{children:s.getHeaderGroups().map(g=>e.jsx(S,{children:g.headers.map(x=>e.jsx(he,{children:x.isPlaceholder?null:_(x.column.columnDef.header,x.getContext())},x.id))},g.id))}),e.jsx(ge,{children:s.getRowModel().rows?.length?s.getRowModel().rows.map(g=>e.jsx(S,{"data-state":g.getIsSelected()&&"selected",children:g.getVisibleCells().map(x=>e.jsx(T,{children:_(x.column.columnDef.cell,x.getContext())},x.id))},g.id)):e.jsx(S,{children:e.jsx(T,{colSpan:G.length,className:"h-24 text-center",children:"No results."})})})]})}),e.jsxs("div",{className:"flex items-center justify-end space-x-2 py-4",children:[e.jsxs("div",{className:"text-muted-foreground flex-1 text-sm",children:[s.getFilteredSelectedRowModel().rows.length," of"," ",s.getFilteredRowModel().rows.length," row(s) selected."]}),e.jsxs("div",{className:"space-x-2",children:[e.jsx(R,{variant:"outline",size:"sm",onClick:()=>s.previousPage(),disabled:!s.getCanPreviousPage(),children:"Previous"}),e.jsx(R,{variant:"outline",size:"sm",onClick:()=>s.nextPage(),disabled:!s.getCanNextPage(),children:"Next"})]})]})]})},qt=re(vt);export{At as clientLoader,qt as default};
