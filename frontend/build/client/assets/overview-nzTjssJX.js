import{w as re}from"./chunk-4WY6JWTD-BRRxSNon.js";import{j as e,r as i}from"./catchall-DRODuvbv.js";import{a as ne,g as ie,A as le,d as de}from"./AlertDialogButton-BsFfMzvQ.js";import{u as ce,a as ue,T as pe,b as me,c as S,d as he,f as _,e as ge,g as T,h as fe,i as xe,j as ve,k as je,C as E,E as be}from"./checkbox-B3ztxBc1.js";import{u as H,s as ye}from"./AuthContext-BiM4paid.js";import{B as R}from"./button-BKkxDiDD.js";import{c as O,u as we,R as Re,I as Ce,D as Ne,a as Se,b as ke,d as De,e as Fe,f as Pe}from"./dropdown-menu-BXhNVCgC.js";import{T as V}from"./index-BQcZugzN.js";import{t as F}from"./index-CfvZiKZg.js";import{I as k}from"./label-BOEwAhi1.js";import{R as Ie,T as Me,C as _e,e as B,d as Te,D as Ee,f as Ae,O as qe,u as ze,a as K,P as C,b as P,g as Ge,h as He}from"./index-DLbcb-1k.js";import{c as j,u as I}from"./utils-Hx-cM7nu.js";import{X as Oe}from"./x-Cohvm7Hp.js";import{d as A,F as Ve,a as w,b as y,c as q}from"./field-hSST5nYM.js";import{c as Be}from"./createLucideIcon-tEOj5wth.js";import{P as Ke}from"./plus-C_DO00tk.js";import"./index-DJR0yQkD.js";const Le=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Ue=Be("circle",Le);function $e({...t}){return e.jsx(Ie,{"data-slot":"dialog",...t})}function We({...t}){return e.jsx(Me,{"data-slot":"dialog-trigger",...t})}function Xe({...t}){return e.jsx(Ae,{"data-slot":"dialog-portal",...t})}function Ye({...t}){return e.jsx(B,{"data-slot":"dialog-close",...t})}function Ze({className:t,...a}){return e.jsx(qe,{"data-slot":"dialog-overlay",className:j("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",t),...a})}function Je({className:t,children:a,showCloseButton:r=!0,...o}){return e.jsxs(Xe,{"data-slot":"dialog-portal",children:[e.jsx(Ze,{}),e.jsxs(_e,{"data-slot":"dialog-content",className:j("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",t),...o,children:[a,r&&e.jsxs(B,{"data-slot":"dialog-close",className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[e.jsx(Oe,{}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]})}function Qe({className:t,...a}){return e.jsx("div",{"data-slot":"dialog-header",className:j("flex flex-col gap-2 text-center sm:text-left",t),...a})}function et({className:t,...a}){return e.jsx("div",{"data-slot":"dialog-footer",className:j("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",t),...a})}function tt({className:t,...a}){return e.jsx(Te,{"data-slot":"dialog-title",className:j("text-lg leading-none font-semibold",t),...a})}function at({className:t,...a}){return e.jsx(Ee,{"data-slot":"dialog-description",className:j("text-muted-foreground text-sm",t),...a})}var M="Radio",[ot,L]=K(M),[st,rt]=ot(M),U=i.forwardRef((t,a)=>{const{__scopeRadio:r,name:o,checked:n=!1,required:d,disabled:l,value:g="on",onCheck:u,form:c,...p}=t,[f,x]=i.useState(null),h=I(a,m=>x(m)),s=i.useRef(!1),b=f?c||!!f.closest("form"):!0;return e.jsxs(st,{scope:r,checked:n,disabled:l,children:[e.jsx(C.button,{type:"button",role:"radio","aria-checked":n,"data-state":Y(n),"data-disabled":l?"":void 0,disabled:l,value:g,...p,ref:h,onClick:P(t.onClick,m=>{n||u?.(),b&&(s.current=m.isPropagationStopped(),s.current||m.stopPropagation())})}),b&&e.jsx(X,{control:f,bubbles:!s.current,name:o,value:g,checked:n,required:d,disabled:l,form:c,style:{transform:"translateX(-100%)"}})]})});U.displayName=M;var $="RadioIndicator",W=i.forwardRef((t,a)=>{const{__scopeRadio:r,forceMount:o,...n}=t,d=rt($,r);return e.jsx(Ge,{present:o||d.checked,children:e.jsx(C.span,{"data-state":Y(d.checked),"data-disabled":d.disabled?"":void 0,...n,ref:a})})});W.displayName=$;var nt="RadioBubbleInput",X=i.forwardRef(({__scopeRadio:t,control:a,checked:r,bubbles:o=!0,...n},d)=>{const l=i.useRef(null),g=I(l,d),u=ce(r),c=He(a);return i.useEffect(()=>{const p=l.current;if(!p)return;const f=window.HTMLInputElement.prototype,h=Object.getOwnPropertyDescriptor(f,"checked").set;if(u!==r&&h){const s=new Event("click",{bubbles:o});h.call(p,r),p.dispatchEvent(s)}},[u,r,o]),e.jsx(C.input,{type:"radio","aria-hidden":!0,defaultChecked:r,...n,tabIndex:-1,ref:g,style:{...n.style,...c,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});X.displayName=nt;function Y(t){return t?"checked":"unchecked"}var it=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],N="RadioGroup",[lt]=K(N,[O,L]),Z=O(),J=L(),[dt,ct]=lt(N),Q=i.forwardRef((t,a)=>{const{__scopeRadioGroup:r,name:o,defaultValue:n,value:d,required:l=!1,disabled:g=!1,orientation:u,dir:c,loop:p=!0,onValueChange:f,...x}=t,h=Z(r),s=we(c),[b,m]=ze({prop:d,defaultProp:n??null,onChange:f,caller:N});return e.jsx(dt,{scope:r,name:o,required:l,disabled:g,value:b,onValueChange:m,children:e.jsx(Re,{asChild:!0,...h,orientation:u,dir:s,loop:p,children:e.jsx(C.div,{role:"radiogroup","aria-required":l,"aria-orientation":u,"data-disabled":g?"":void 0,dir:s,...x,ref:a})})})});Q.displayName=N;var ee="RadioGroupItem",te=i.forwardRef((t,a)=>{const{__scopeRadioGroup:r,disabled:o,...n}=t,d=ct(ee,r),l=d.disabled||o,g=Z(r),u=J(r),c=i.useRef(null),p=I(a,c),f=d.value===n.value,x=i.useRef(!1);return i.useEffect(()=>{const h=b=>{it.includes(b.key)&&(x.current=!0)},s=()=>x.current=!1;return document.addEventListener("keydown",h),document.addEventListener("keyup",s),()=>{document.removeEventListener("keydown",h),document.removeEventListener("keyup",s)}},[]),e.jsx(Ce,{asChild:!0,...g,focusable:!l,active:f,children:e.jsx(U,{disabled:l,required:d.required,checked:f,...u,...n,name:d.name,ref:p,onCheck:()=>d.onValueChange(n.value),onKeyDown:P(h=>{h.key==="Enter"&&h.preventDefault()}),onFocus:P(n.onFocus,()=>{x.current&&c.current?.click()})})})});te.displayName=ee;var ut="RadioGroupIndicator",ae=i.forwardRef((t,a)=>{const{__scopeRadioGroup:r,...o}=t,n=J(r);return e.jsx(W,{...n,...o,ref:a})});ae.displayName=ut;var pt=Q,mt=te,ht=ae;function gt({className:t,...a}){return e.jsx(pt,{"data-slot":"radio-group",className:j("grid gap-3",t),...a})}function D({className:t,...a}){return e.jsx(mt,{"data-slot":"radio-group-item",className:j("border-input text-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 aspect-square size-4 shrink-0 rounded-full border shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",t),...a,children:e.jsx(ht,{"data-slot":"radio-group-indicator",className:"relative flex items-center justify-center",children:e.jsx(Ue,{className:"fill-primary absolute top-1/2 left-1/2 size-2 -translate-x-1/2 -translate-y-1/2"})})})}function ft({className:t,...a}){return e.jsx("textarea",{"data-slot":"textarea",className:j("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),...a})}const z={name:"ex. drink more water",description:"Optionally include a brief description...",status:"active",unit:"unit",frequency:"daily",goal:0,reminder_time:null,is_archived:!1};function xt({isOpen:t,open:a}){const{user:r}=H(),[o,n]=i.useState(z),d=u=>{n(c=>({...c,frequency:u}))},l=u=>{const{name:c,value:p,type:f}=u.target;n(x=>({...x,[c]:c==="goal"?Number(p):p}))},g=async u=>{if(u.preventDefault(),console.log("touched",o),!r||o===z)return;const c=new V().toISOString().split("T")[0];try{await ne({user_id:r.id,name:o.name,description:o.description==="Optionally include a brief description..."?"":o.description,status:"active",unit:o.unit,frequency:o.frequency,goal:o.goal,reminder_time:null,is_archived:!1}),setHabits(p=>[...p,{...o,created_at:c}]),t(!1),F.success("Successfully added a new habit.")}catch{F.error("Failed to create.")}};return e.jsx(e.Fragment,{children:e.jsx($e,{open:a,onOpenChange:t,children:e.jsxs("form",{children:[e.jsx(We,{asChild:!0,children:e.jsxs(R,{variant:"outline",children:[e.jsx(Ke,{})," Habit"]})}),e.jsxs(Je,{className:"sm:max-w-[425px]",children:[e.jsxs(Qe,{children:[e.jsx(tt,{children:"Create a new Habit."}),e.jsx(at,{children:"Fill out the form here. Click create when you're done."})]}),e.jsx("div",{className:"w-full max-w-md",children:e.jsx(A,{children:e.jsxs(Ve,{children:[e.jsxs(w,{children:[e.jsx(y,{htmlFor:"name",children:"Habit Name"}),e.jsx(k,{id:"name",name:"name",type:"text",placeholder:"ex. drink more water",onChange:l,required:!0}),e.jsx(q,{children:"Choose the name of your new habit."})]}),e.jsxs(w,{children:[e.jsx(y,{htmlFor:"feedback",children:"Description"}),e.jsx(ft,{id:"description",name:"description",placeholder:"Optionally include a brief description...",rows:4,onChange:l})]}),e.jsxs(A,{children:[e.jsx(y,{children:"Frequency Plan"}),e.jsx(q,{children:"Select how frequent you plan to perform this habit."}),e.jsxs(gt,{name:"frequency",defaultValue:"daily",onValueChange:d,required:!0,children:[e.jsxs(w,{orientation:"horizontal",children:[e.jsx(D,{value:"daily",id:"plan-daily"}),e.jsx(y,{htmlFor:"plan-daily",className:"font-normal",children:"Daily"})]}),e.jsxs(w,{orientation:"horizontal",children:[e.jsx(D,{value:"weekly",id:"plan-weekly"}),e.jsx(y,{htmlFor:"plan-weekly",className:"font-normal",children:"Weekly"})]}),e.jsxs(w,{orientation:"horizontal",children:[e.jsx(D,{value:"monthly",id:"plan-monthly"}),e.jsx(y,{htmlFor:"plan-monthly",className:"font-normal",children:"Monthly"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs(w,{children:[e.jsx(y,{htmlFor:"city",children:"Frequency Goal"}),e.jsx(k,{id:"goal",name:"goal",type:"number",min:0,placeholder:"0",onChange:l,required:!0})]}),e.jsxs(w,{children:[e.jsx(y,{htmlFor:"unit",children:"Unit To Measure"}),e.jsx(k,{id:"unit",name:"unit",type:"text",placeholder:"ex. ounces or oz",onChange:l,required:!0})]})]})]})})}),e.jsxs(et,{children:[e.jsx(Ye,{asChild:!0,children:e.jsx(R,{variant:"outline",children:"Cancel"})}),e.jsx(R,{type:"submit",onClick:g,children:"Create Habit"})]})]})]})})})}async function At(){const{data:{user:t}}=await ye.auth.getUser();return t?await ie(t.id):void 0}const G=[{id:"select",header:({table:t})=>e.jsx(E,{checked:t.getIsAllPageRowsSelected()||t.getIsSomePageRowsSelected()&&"indeterminate",onCheckedChange:a=>t.toggleAllPageRowsSelected(!!a),"aria-label":"Select all"}),cell:({row:t})=>e.jsx(E,{checked:t.getIsSelected(),onCheckedChange:a=>{t.toggleSelected(!!a)},"aria-label":"Select row"}),enableSorting:!1,enableHiding:!1},{accessorKey:"name",header:"Name",cell:({row:t})=>e.jsx("div",{className:"capitalize",children:t.getValue("name")})},{accessorKey:"goal",header:"Frequency Goal",cell:({row:t})=>e.jsx("div",{className:"capitalize",children:t.getValue("goal")})},{accessorKey:"frequency",header:"Frequency",cell:({row:t})=>e.jsx("div",{className:"capitalize",children:t.getValue("frequency")})},{accessorKey:"unit",header:()=>e.jsx("div",{className:"capitalize",children:"Unit Type"}),cell:({row:t})=>e.jsx("div",{className:" font-semibold text-slate-500",children:t.getValue("unit")})},{accessorKey:"status",header:"Status",cell:({row:t})=>e.jsx("div",{className:"capitalize",children:t.getValue("status")})},{accessorKey:"created_at",header:"Created At",cell:({row:t})=>{const a=new V(t.getValue("created_at")).toISOString().split("T")[0];return e.jsx("div",{className:"capitalize",children:a})}},{id:"actions",enableHiding:!1,cell:({row:t})=>{const a=t.original;return e.jsxs(Ne,{children:[e.jsx(Se,{asChild:!0,children:e.jsxs(R,{variant:"ghost",className:"h-8 w-8 p-0",children:[e.jsx("span",{className:"sr-only",children:"Open menu"}),e.jsx(be,{})]})}),e.jsxs(ke,{align:"end",children:[e.jsx(De,{children:"Actions"}),e.jsx(Fe,{onClick:()=>navigator.clipboard.writeText(a.id),children:"Copy Entry ID"}),e.jsx(Pe,{})]})]})}}],vt=({loaderData:t})=>{const{user:a}=H(),[r,o]=i.useState(!1),[n,d]=i.useState(t),[l,g]=i.useState([]),[u,c]=i.useState([]),[p,f]=i.useState({}),[x,h]=i.useState({}),s=ue({data:n,columns:G,onSortingChange:g,onColumnFiltersChange:c,getCoreRowModel:je(),getPaginationRowModel:ve(),getSortedRowModel:xe(),getFilteredRowModel:fe(),onColumnVisibilityChange:f,onRowSelectionChange:h,state:{sorting:l,columnFilters:u,columnVisibility:p,rowSelection:x}}),b=async()=>{if(!a)return;const m=s.getFilteredSelectedRowModel().rows.map(v=>v.original.id);await de(m),d(v=>v.filter(oe=>!m.find(se=>se===oe.id))),h({}),F.success("Habit(s) deleted")};return i.useEffect(()=>{n.length===0&&o(!0)},[]),e.jsxs("div",{className:"w-full",children:[e.jsx("div",{className:"flex items-center py-4",children:e.jsxs("div",{className:"flex ml-auto gap-2 w-full max-w-sm ",children:[e.jsx("div",{className:"w-full",children:e.jsx(le,{onContinue:b,variant:s.getFilteredSelectedRowModel().rows.length>0?"destructive":"outline",disabled:s.getFilteredSelectedRowModel().rows.length<=0,dialingDesc:"Action cannot be undone.",buttonText:`Delete ${s.getFilteredSelectedRowModel().rows.length>0?`Batch (${s.getFilteredSelectedRowModel().rows.length} rows)`:""}`})}),e.jsx(xt,{open:r,isOpen:o})]})}),e.jsx("div",{className:"overflow-hidden rounded-md border",children:e.jsxs(pe,{children:[e.jsx(me,{children:s.getHeaderGroups().map(m=>e.jsx(S,{children:m.headers.map(v=>e.jsx(he,{children:v.isPlaceholder?null:_(v.column.columnDef.header,v.getContext())},v.id))},m.id))}),e.jsx(ge,{children:s.getRowModel().rows?.length?s.getRowModel().rows.map(m=>e.jsx(S,{"data-state":m.getIsSelected()&&"selected",children:m.getVisibleCells().map(v=>e.jsx(T,{children:_(v.column.columnDef.cell,v.getContext())},v.id))},m.id)):e.jsx(S,{children:e.jsx(T,{colSpan:G.length,className:"h-24 text-center",children:"No results."})})})]})}),e.jsxs("div",{className:"flex items-center justify-end space-x-2 py-4",children:[e.jsxs("div",{className:"text-muted-foreground flex-1 text-sm",children:[s.getFilteredSelectedRowModel().rows.length," of"," ",s.getFilteredRowModel().rows.length," row(s) selected."]}),e.jsxs("div",{className:"space-x-2",children:[e.jsx(R,{variant:"outline",size:"sm",onClick:()=>s.previousPage(),disabled:!s.getCanPreviousPage(),children:"Previous"}),e.jsx(R,{variant:"outline",size:"sm",onClick:()=>s.nextPage(),disabled:!s.getCanNextPage(),children:"Next"})]})]})]})},qt=re(vt);export{At as clientLoader,qt as default};
